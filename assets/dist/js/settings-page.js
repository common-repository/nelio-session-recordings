(()=>{var e={n:n=>{var t=n&&n.__esModule?()=>n.default:()=>n;return e.d(t,{a:t}),t},d:(n,t)=>{for(var o in t)e.o(t,o)&&!e.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:t[o]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};(()=>{"use strict";e.r(n),e.d(n,{initPage:()=>k});const t=window.wp.element;window.wp.domReady;const o=window.wp.notices,r=window.wp.components,i=window.wp.data,s=window.wp.i18n;var l=function(){return t.createElement("h1",{className:"wp-heading-inline nelio-session-recordings__page-title"},t.createElement("span",null,(0,s._x)("Nelio Session Recordings – Settings","text","nelio-session-recordings")))};const a=window.wp.apiFetch;var c=e.n(a);const d=window.wp.date,u=window.wp.url;var m=function(){return m=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},m.apply(this,arguments)};var g=function(e){var n,t;return!!(null===(n=e.url)||void 0===n?void 0:n.includes("/wp-json/"))||!!(null===(t=e.url)||void 0===t?void 0:t.includes("rest_route"))||!!Object.keys(e).includes("rest_route")};const p=window.neliosr.components,v=window.neliosr.utils;var h=function(){return h=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},h.apply(this,arguments)},f=function(e){var n,o,i,l,a,f=e.settings,E=(0,t.useState)(!1),b=E[0],y=E[1],C=(0,t.useState)(!1),k=C[0],S=C[1],R=(0,t.useState)(f),N=R[0],O=R[1];return t.createElement(t.Fragment,null,t.createElement("h2",null,(0,s._x)("Recording Settings","text","nelio-session-recordings")),t.createElement("table",{className:"form-table neliosr-recording-settings",role:"presentation"},t.createElement("tbody",null,t.createElement("tr",null,t.createElement("th",{scope:"row"},t.createElement("span",null,(0,s._x)("GDPR Cookie","text","nelio-session-recordings"))),t.createElement("td",null,!!N.isNabActive&&t.createElement(r.CheckboxControl,{label:(0,s._x)("Customize default behavior","text","nelio-session-recordings"),disabled:b,checked:!!(null===(n=N.gdprCookie)||void 0===n?void 0:n.customize),onChange:function(e){var n,t;return O(h(h({},N),{gdprCookie:{customize:e,name:(null===(n=N.gdprCookie)||void 0===n?void 0:n.name)||"",value:(null===(t=N.gdprCookie)||void 0===t?void 0:t.value)||""}}))}}),(!N.isNabActive||!!(null===(o=N.gdprCookie)||void 0===o?void 0:o.customize))&&t.createElement(t.Fragment,null,t.createElement("div",{className:"neliosr-component-with-help",style:{marginTop:N.isNabActive?"1em":"auto"}},t.createElement("span",{className:"dashicons dashicons-editor-help neliosr-description-icon",onClick:function(){return S(!k)},"aria-hidden":"true"}),t.createElement(r.TextControl,{value:(null===(i=N.gdprCookie)||void 0===i?void 0:i.name)||"",disabled:b,onChange:function(e){var n;return O(h(h({},N),{gdprCookie:{name:e,customize:!0,value:(null===(n=N.gdprCookie)||void 0===n?void 0:n.value)||""}}))},placeholder:(0,s._x)("Cookie Name","text","nelio-session-recordings")})),!!(null===(l=N.gdprCookie)||void 0===l?void 0:l.name)&&t.createElement(r.TextControl,{className:"neliosr-recording-settings__gdpr-cookie-value",disabled:b,value:(null===(a=N.gdprCookie)||void 0===a?void 0:a.value)||"",onChange:function(e){var n;return O(h(h({},N),{gdprCookie:{name:(null===(n=N.gdprCookie)||void 0===n?void 0:n.name)||"",value:e,customize:!0}}))},placeholder:(0,s._x)("Optional Cookie Value","text","nelio-session-recordings")}),!!k&&t.createElement("div",{className:"neliosr-setting-description"},t.createElement("p",null,(0,s._x)("The name of the cookie that should exist if GDPR has been accepted and, therefore, tracking is allowed. Leave empty if you don’t need to adhere to GDPR and want to track all your visitors.","user","nelio-session-recordings")),t.createElement("p",null,(0,s._x)("If you want to, you can also specify the value the cookie should have to enable visitor tracking.","user","nelio-session-recordings")),t.createElement("p",null,(0,s._x)("Use asterisks (*) to match any number of characters at any point.","user","nelio-session-recordings")))))),t.createElement("tr",null,t.createElement("th",{scope:"row"},t.createElement("span",null,(0,s._x)("Tracking settings","text","nelio-session-recordings"))),t.createElement("td",null,t.createElement(r.CheckboxControl,{label:(0,s._x)("Capture sessions shorter than 30 seconds","command","nelio-session-recordings"),disabled:b,checked:N.trackShortSessions,onChange:function(e){return O(h(h({},N),{trackShortSessions:e}))}}))),t.createElement("tr",null,t.createElement("th",{scope:"row"},t.createElement("span",null,(0,s._x)("Sampling rate","text","nelio-session-recordings"))),t.createElement("td",null,t.createElement(r.SelectControl,{className:"neliosr-recording-settings__sampling-rate-selector",disabled:b,value:N.samplingRate.mode,help:x(N.samplingRate.mode),options:_,onChange:function(e){return O(h(h({},N),{samplingRate:w(e,N.samplingRate)}))}}),"custom"===N.samplingRate.mode&&t.createElement(r.RangeControl,{className:"neliosr-recording-settings__sampling-rate-percentage",label:(0,s._x)("Percentage of tracked sessions (%)","text","nelio-session-recordings"),disabled:b,value:N.samplingRate.percentage,onChange:function(e){return O(h(h({},N),{samplingRate:{mode:"custom",percentage:e||100}}))},initialPosition:100,min:0,max:100,step:1,renderTooltipContent:function(e){return"".concat(e,"%")}}),"uniform"===N.samplingRate.mode&&t.createElement(p.NumberControl,{className:"neliosr-recording-settings__sampling-rate-amount",label:(0,s._x)("Estimated amount of monthly sessions","text","nelio-session-recordings"),value:N.samplingRate.estimatedSessions,min:0,onChange:function(e){return O(h(h({},N),{samplingRate:{mode:"uniform",estimatedSessions:e||0}}))}}))),t.createElement("tr",null,t.createElement("th",{scope:"row"},t.createElement("span",null,(0,s._x)("Scope URLs","text","nelio-session-recordings"))),t.createElement("td",null,t.createElement(r.TextareaControl,{className:"neliosr-recording-settings__recordings-scope",disabled:b,cols:50,value:N.recordingsScope.join("\n"),onChange:function(e){return O(h(h({},N),{recordingsScope:e.split("\n")}))},placeholder:(0,s._x)("One URL per line","text","nelio-session-recordings"),help:(0,s._x)("Use this field to specify the URL(s) where recordings should be tracked. Please write one URL or URL fragment per line. Leave empty to track recordings on the whole site.","user","nelio-session-recordings")}))))),t.createElement(r.Button,{variant:"primary",disabled:b,isBusy:b,onClick:function(){var e,n,t,o;y(!0),(e={path:"/neliosr/v1/settings",method:"POST",data:{settings:N}},n=e.url,t=e.path,o=(0,d.format)("YmjHi").substring(0,11)+"0",c()(m(m(m({},e),n&&{url:g(e)?(0,u.addQueryArgs)(n,{neliosrts:o}):n}),t&&{path:(0,u.addQueryArgs)(t,{neliosrts:o})}))).catch((function(e){(0,v.createErrorNotice)(e,(0,s._x)("Error while accessing amount of active recordings.","text","nelio-session-recordings"))})).finally((function(){y(!1)}))}},(0,s._x)("Save Changes","command","nelio-session-recordings")))};function w(e,n){switch(e){case"unlimited":return{mode:e};case"uniform":return{mode:e,estimatedSessions:"uniform"===n.mode?n.estimatedSessions:5e3};case"custom":return{mode:e,percentage:"custom"===n.mode?n.percentage:75}}}function x(e){switch(e){case"unlimited":return(0,s._x)("Every visitor session will be recorded until you run out of quota","text","nelio-session-recordings");case"uniform":return(0,s._x)("Record your sessions evenly throughout the calendar month","text","nelio-session-recordings");case"custom":return(0,s._x)("A percentage of your visitor sessions will be recorded","text","nelio-session-recordings")}}var E,_=[{value:"unlimited",label:(0,s._x)("Unlimited","text","nelio-content")},{value:"uniform",label:(0,s._x)("Uniform","text","nelio-content")},{value:"custom",label:(0,s._x)("Custom percentage","text","nelio-content")}],b=null!==(E=null===o.store||void 0===o.store?void 0:o.store.name)&&void 0!==E?E:"core/notices",y=function(e){var n=e.settings,o=n.hideTitle,s=C(),a=(0,i.useDispatch)(b).removeNotice;return t.createElement(t.Fragment,null,!o&&t.createElement(l,null),t.createElement(r.NoticeList,{notices:s,className:"components-editor-notices__pinned",onRemove:a}),t.createElement(f,{settings:n}))},C=function(){return(0,i.useSelect)((function(e){return e(b).getNotices()}))};function k(e,n){var o,r,i=document.getElementById(e);o=t.createElement("div",{className:"wrap"},t.createElement(y,{settings:n})),(r=i)&&(t.createRoot?(0,t.createRoot)(r).render(o):(0,t.render)(o,r))}})();var t=neliosr="undefined"==typeof neliosr?{}:neliosr;for(var o in n)t[o]=n[o];n.__esModule&&Object.defineProperty(t,"__esModule",{value:!0})})();